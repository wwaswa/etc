THis code was modified by Bill
